#!/bin/bash
set -e

IFS="." read -a quackfilenameroot <<< "$1"

python HW3/lark_parser.py $1 ${quackfilenameroot[0]} ./builtinclass.json
if [[ $? != 0 ]] ;  then
    exit 1;
fi;

files=`cat final_file_list`
rm -f temp_file

for output_asm in ${files[@]}; do
    python assemble.py ${output_asm}.asm OBJ/${output_asm}.json
    echo "Compiled ${output_asm}.asm to OBJ/${output_asm}.json"
done
